---
output: gfm
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

[![Build Status](https://travis-ci.org/ATFutures/nyped.svg)](https://travis-ci.org/ATFutures/nyped) 
[![Project Status: Concept - Minimal or no implementation has been done yet.](http://www.repostatus.org/badges/0.1.0/concept.svg)](http://www.repostatus.org/#concept)

# nyped

Model of pedestrian flows against empirical [pedestrian counts for New York
City](https://www1.nyc.gov/html/dot/html/about/datafeeds.shtml#Pedestrians).

Final result looks like this:
```{r load, echo = FALSE}
library (ggplot2)
theme_set (theme_minimal ())
devtools::load_all (".", export_all = FALSE)
data_dir <- "/data/data/moveability/nyc"
```

```{r layer-scales}
x <- calc_layer_scales (data_dir, model = "final")
knitr::kable (x)
```

With the following model statistics:
```{r model-stats}
dat <- readRDS (file.path (data_dir, "ped-model-final.Rds"))
f_ <- dat$flowvars
summary (lm (dat$p ~ f_))
```

The final flow model looks like this:

![](./man/figures/flowmap.png)

And a final statistical relationship between modelled and observed pedestrian
counts that looks like this:
```{r model-plot}
data_dir <- "/data/data/moveability/nyc"
dat <- readRDS (file.path (data_dir, "ped-model-final.Rds"))
mod <- lm (dat$p ~ dat$flowvars)
res <- data.frame (predicted = predict (mod),
                   actual = dat$p)
ggplot (res, aes (x = predicted, y = actual)) +
    geom_point () +
    geom_smooth (method = "lm")
```
